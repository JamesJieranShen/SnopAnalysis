{
  "steps": [
    {
      "type": "run_provider"
      // "directory": "/nfs/disk1/snoplus/bismsb/Analysis15_bMR_801_802_Bronze_358080_364310_Apr2025",
      // "directory": "/nfs/disk2/jierans/Analysis15_bMR_801_802_Bronze_358080_364310_Apr2025",
      // "module_name": "Analysis15_bMR"
    },
    {
      "type": "delta_t",
      "comment": "adjacent event delta_t for retrigger calculation",
      "column_name": "delta_t",
      "file_name": "/nfs/disk1/users/jierans/snoplus/bismsb_roi/cache/deltat_Analysis15_bMR_801_802_Bronze_358080_364310.ntuple.root",
      "tree_name": "output"
    },
    { "type": "define", "name": "retrigger", "expr": "delta_t==460" },
    {
      "type": "coincidence",
      "comment": "BiPo214",
      "time_window": 1e6,
      "delta_r_limit": 1500,
      "label": "BiPo214",
      "prompt_expr": "retrigger==0",
      "delayed_expr": "retrigger==0 && energy > 0.5 && energy < 10.0"
    },
    {
      "type": "coincidence",
      "comment": "retrigger that follows a Bipo214 prompt event",
      "time_window": 500,
      "label": "Bi214_retrigger",
      "prompt_expr": "BiPo214_prompt",
      "delayed_expr": "retrigger==1"
    },
    {
      "type": "coincidence",
      "comment": "Events with large nhits in the retriggers",
      "time_window": 500,
      "label": "large_nhit_retrigger",
      "prompt_expr": "(retrigger==0)",
      "delayed_expr": "(retrigger==1) && (nhitsCleaned > 40)"
    },
    {
      "type": "coincidence",
      "comment": "Events that follow a large nhit event",
      "time_window": 5e6,
      "label": "he_event",
      "prompt_expr": "(nhitsCleaned > 3000)",
      "delayed_expr": "true"
    },
    {
      "type": "coincidence",
      "comment": "hotspot",
      "time_window": 1e9,
      "label": "hotspot",
      "prompt_expr": "(nhitsCleaned > 3000) && (posz_av > 5500) && ((posx > 500 && posx < 900 && posy > -900 && posy < -500) || (posx > 0 && posx < 500 && posy > -1250 && posy < -800))",
      "delayed_expr": "true"
    },
    { "type": "describe", "short_format": true },
    // { "type": "filter", "expr": "fitValid == true", "name": "fitValid", "comment": "fitValid" },
    // { "type": "filter", "expr": "energy > 0.6", "comment": "energy > 0.6MeV" },
    // { "type": "filter", "expr": "posr_av < 5200", "comment": "fiducial volume R < 5.2m" },
    // { "type": "filter", "expr": "delta_t != 460", "comment": "Remove retriggers" },
    { "type": "report" },
    {
      "type": "snapshot",
      "tree_name": "output",
      "lazy": true
    }
  ]
}
