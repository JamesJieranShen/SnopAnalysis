{
  "steps": [
    {
      "type": "run_provider"
      // directory and module name provided by command line
    },
    {
      "type": "delta_t",
      "comment": "adjacent event delta_t for retrigger calculation"
    },
    { "type": "define", "name": "retrigger", "expr": "delta_t<=460" },
    {
      "type": "coincidence",
      "comment": "BiPo214",
      "time_window": 2e6,
      "delta_r_limit": 1500,
      "label": "BiPo214",
      "prompt_expr": "retrigger==0",
      "delayed_expr": "retrigger==0 && energy > 0.5 && energy < 10.0"
    },
    {
      "type": "coincidence",
      "comment": "retrigger that follows a Bipo214 prompt event",
      "time_window": 500,
      "label": "Bi214_retrigger",
      "prompt_expr": "BiPo214_prompt",
      "delayed_expr": "retrigger==1"
    },
    {
      "type": "coincidence",
      "comment": "Events with large nhits in the retriggers",
      "time_window": 500,
      "label": "large_nhit_retrigger",
      "prompt_expr": "(retrigger==0)",
      "delayed_expr": "(retrigger==1) && (nhits > 40)"
    },
    {
      "type": "coincidence",
      "comment": "Events that follow a large nhit event",
      "time_window": 5e6,
      "label": "he_event",
      "prompt_expr": "(nhits > 3000)",
      "delayed_expr": "true"
    },
    {
      "type": "coincidence",
      "comment": "hotspot",
      "time_window": 1e9,
      "label": "hotspot",
      "prompt_expr": "(nhits > 3000) && (posz_av > 5500) && ((posx > 500 && posx < 900 && posy > -900 && posy < -500) || (posx > 0 && posx < 500 && posy > -1250 && posy < -800))",
      "delayed_expr": "true"
    },
    { "type": "describe", "short_format": true },
    {
      "type": "filter",
      "expr": "((dcApplied & 0xD82100000162C6) & dcFlagged) == (dcApplied & 0xD82100000162C6)",
      "name": "DCMask"
    },
    { "type": "filter", "expr": "nhitsCleaned > 200", "name": "nhitsCleaned" },
    { "type": "filter", "expr": "!retrigger", "comment": "No retrigger", "name": "retrigger" },
    { "type": "filter", "expr": "fitValid == true", "name": "fitValid", "comment": "fitValid" },
    { "type": "filter", "expr": "energy > 0.6 && energy < 5.0", "comment": "energy [0.6MeV, 5MeV]", "name": "Energy" },
    { "type": "report" },
    {
      "type": "snapshot",
      "tree_name": "output",
      "lazy": false,
      "prune_columns": [
        "pdg1",
        "pdg2",
        "parentpdg1",
        "parentpdg2",
        "parentKE1",
        "parentKE2",
        "parentMeta1",
        "parentMeta2",
        "mcke1",
        "mcke2",
        "mcmom1x",
        "mcmom1y",
        "mcmom1z",
        "mcmom2x",
        "mcmom2y",
        "mcmom2z",
        "mctime1",
        "mctime2",
        "mct",
        "mcEdep",
        "mcEdepQuenched",
        "mcNCherPhotons",
        "mcPosx",
        "mcPosy",
        "mcPosz",
        "mcPosr",
        "isCal",
        "fecdHits",
        "q",
        "triggerWord",
        "tubiiWord",
        "waterFit",
        "partialWaterFit",
        "partialFit",
        "posx_MultiPath",
        "posy_MultiPath",
        "posz_MultiPath",
        "posr_MultiPath",
        "time_MultiPath",
        "posz_fastZ",
        "time_fastZ",
        "fitValid_MultiPath",
        "fitValid_fastZ",
        "posFOM_Multipath",
        "posFOM2_Multipath",
        "dirx",
        "dirxPosError",
        "dirxNegError",
        "diry",
        "diryPosError",
        "diryNegError",
        "dirz",
        "dirzPosError",
        "dirzNegError",
        "dirFOM",
        "dirFOM2",
        "energyFOMmedProb",
        "energyFOMmedProbHit",
        "energyFOMmedDev",
        "energyFOMmedDevHit",
        "energyFOMGtest",
        "energyFOMUtest",
        "penergyEnergy",
        "penergyError",
        "penergyAEnergy",
        "penergyAError",
        "penergyCEnergy",
        "penergyCError",
        "xsite",
        "timingPeaks",
        "qpdtProbability",
        "qpdtNhitsEarly",
        "qpdtQMax",
        "meanTime",
        "earlyTime",
        "preTriggerHits",
        "isotropyRegions",
        "latIsotropyRegions",
        "biPoCumul",
        "biPoLikelihood212",
        "biPoLikelihood214",
        "mCPitr",
        "mCPLogL10",
        "mCPLogL20",
        "mCPLogL30",
        "annR",
        "nearAV",
        "skyShine",
        "topOWLCount",
        "tcen_x",
        "tcen_y",
        "tcen_z"
      ]
    }
  ]
}
