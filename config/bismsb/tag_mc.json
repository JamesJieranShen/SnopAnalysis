{
  "steps": [
    { "type": "glob_provider" },
    {
      "type": "count",
      // "name":
      "count_mc": true,
      "count_total": false
    },
    // this is needed to make sure delta T calculation is correct.
    { "type": "filter", "expr": "evIndex >= 0", "name": "TriggerdEvents" },
    {
      "type": "delta_t",
      "comment": "adjacent event delta_t for retrigger calculation"
    },
    { "type": "define", "name": "retrigger", "expr": "delta_t<=460" },
    { "type": "describe", "short_format": true },

    // do not run data cleaning over MC
    // {
    //   "type": "filter",
    //   "expr": "((dcApplied & 0xD82100000162C6) & dcFlagged) == (dcApplied & 0xD82100000162C6)",
    //   "name": "DCMask"
    // },
    { "type": "filter", "expr": "nhitsCleaned > 200", "name": "nhitsCleaned" },
    {
      "type": "filter",
      "expr": "!retrigger",
      "comment": "No retrigger",
      "name": "retrigger"
    },
    {
      "type": "filter",
      "expr": "fitValid == true",
      "name": "fitValid",
      "comment": "fitValid"
    },
    {
      "type": "filter",
      "expr": "energy > 0.6 && energy < 6.0",
      "comment": "energy [0.6MeV, 6MeV]",
      "name": "Energy"
    },
    {
      "type": "filter",
      "expr": "posr_av < 3300",
      "comment": "fiducial volume R < 3.3m",
      "name": "FiducialVolume"
    },
    // stage 1: Classifier cuts
    // {
    //   "type": "filter",
    //   "expr": "alphaBeta212 > 0 || nhitsCleaned < 400",
    //   "name": "BiPo212-AlphaBeta"
    // },
    { "type": "filter", "expr": "beta14 > -0.1 && beta14 < 0.04", "name": "Beta14" },
    {
      "type": "filter",
      "expr": "(posFOM / nhitsCleaned > 12) && (necknhits / nhitsCleaned < 0.01) && (pow(posxPosError - posxNegError, 2) + pow(posyPosError - posyNegError, 2) + pow(poszPosError - poszNegError, 2) < pow(900, 2))",
      "name": "HighNeck, no ITR/Quad cut"
    },
    { "type": "report" },
    {
      "type": "snapshot",
      "tree_name": "output",
      "lazy": false,
      // provided by command line
      //"file_name": "ScintFit_2p2ppo_2p2bismsbTl208Run_801_Bronze_354099_364310_tagged_mc.root",
      "prune_columns": [
        "isCal",
        "fecdHits",
        "triggerWord",
        "tubiiWord",
        "waterFit",
        "partialWaterFit",
        "partialFit",
        "posx_MultiPath",
        "posy_MultiPath",
        "posz_MultiPath",
        "posr_MultiPath",
        "time_MultiPath",
        "posz_fastZ",
        "time_fastZ",
        "fitValid_MultiPath",
        "fitValid_fastZ",
        "posFOM_Multipath",
        "posFOM2_Multipath",
        "dirx",
        "dirxPosError",
        "dirxNegError",
        "diry",
        "diryPosError",
        "diryNegError",
        "dirz",
        "dirzPosError",
        "dirzNegError",
        "dirFOM",
        "dirFOM2",
        "energyFOMmedProb",
        "energyFOMmedProbHit",
        "energyFOMmedDev",
        "energyFOMmedDevHit",
        "energyFOMGtest",
        "energyFOMUtest",
        "penergyEnergy",
        "penergyError",
        "penergyAEnergy",
        "penergyAError",
        "penergyCEnergy",
        "penergyCError",
        "timingPeaks",
        "qpdtProbability",
        "qpdtNhitsEarly",
        "qpdtQMax",
        "meanTime",
        "earlyTime",
        "preTriggerHits",
        "isotropyRegions",
        "latIsotropyRegions",
        "biPoCumul",
        "biPoLikelihood212",
        "biPoLikelihood214",
        "mCPitr",
        "mCPLogL10",
        "mCPLogL20",
        "mCPLogL30",
        "annR",
        "nearAV",
        "skyShine",
        "topOWLCount",
        "tcen_x",
        "tcen_y",
        "tcen_z"
      ]
    }
  ]
}
