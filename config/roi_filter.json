{
  "steps": [
    {
      "type": "tchain_provider",
      "parts": [
        {
          "tree_name": "output",
          "files": ["/nfs/disk1/users/jierans/snoplus/bismsb_roi/tagged-files/*.ntuple.root"]
        }
      ]
    },
    { "type": "describe", "short_format": true },
    // stage 0: Basic cuts
    { "type": "filter", "expr": "nhitsCleaned > 200", "name": "nhitsCleaned" }, // should be removed after reprocessing
    { "type": "filter", "expr": "posr_av < 3300", "comment": "fiducial volume R < 3.3m", "name": "FiducialVolume" },
    {
      "type": "snapshot",
      "tree_name": "output",
      "lazy": true,
      "file_name": "/nfs/disk1/users/jierans/snoplus/bismsb_roi/roi_events_stage0.ntuple.root"
    },
    // stage 1: Classifier cuts
    { "type": "filter", "expr": "alphaBeta212 > 0 || nhitsCleaned < 400", "name": "BiPo212-AlphaBeta" },
    {
      "type": "filter",
      "expr": "(posFOM / nhitsCleaned > 12) && (necknhits / nhitsCleaned < 0.01) && (pow(posxPosError - posxNegError, 2) + pow(posyPosError - posyNegError, 2) + pow(poszPosError - poszNegError, 2) < pow(900, 2))",
      "name": "HighNeck, no ITR/Quad cut"
    },
    {
      "type": "snapshot",
      "tree_name": "output",
      "lazy": true,
      "file_name": "/nfs/disk1/users/jierans/snoplus/bismsb_roi/roi_events_stage1.ntuple.root"
    },

    // stage 2: Coincidence cuts
    { "type": "filter", "expr": "!BiPo214_prompt && !BiPo214_follower", "name": "BiPo214Coincidence" },
    { "type": "filter", "expr": "!he_event_prompt && !he_event_follower", "name": "HighEnergyVeto" },
    { "type": "filter", "expr": "!hotspot_prompt && !hotspot_follower", "name": "HotspotVeto" },
    { "type": "report" },
    {
      "type": "snapshot",
      "tree_name": "output",
      "lazy": false,
      "file_name": "/nfs/disk1/users/jierans/snoplus/bismsb_roi/roi_events.ntuple.root"
    }
  ]
}
